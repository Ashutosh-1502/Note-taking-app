<% layout('layouts/boilerplate2')%>

<div class="container mt-5 pt-5">
    <div class="row">
        <div class="col-12">
            <!-- Breadcrumb Navigation -->
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/dashboard" class="fw-bold text-decoration-none">Dashboard</a></li>
                    <li class="breadcrumb-item active" aria-current="page">Add Note</li>
                </ol>
            </nav>
        </div>

        <!-- Page Title -->
        <div class="col-12">
            <h2 class="fw-bold">Add a New Note</h2>
        </div>

        <!-- Note Form -->
        <div class="col-12">
            <div class="bg-white p-4 rounded shadow">
                <form id="updateForm" action="/item/<%= note._id %>/update?_method=PATCH" method="POST">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Note Title</label>
                        <input type="text" class="form-control" name="title" placeholder="Enter title..." value="<%= note.title %>" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Note Content</label>
                        <textarea class="form-control" name="Note" rows="6" placeholder="Write your note..." required><%= note.Note %></textarea>
                    </div>
                    <div class="d-grid">
                        <button type="button" class="btn btn-success rounded-pill fw-bold" data-bs-toggle="modal" data-bs-target="#updateModal">
                            Update Note
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Delete Button -->
        <div class="col-12 text-end mt-3">
            <form action="/item/<%= note._id %>/delete?_method=DELETE" method="POST">
                <button type="button" class="btn btn-danger rounded-pill px-4" data-bs-toggle="modal" data-bs-target="#deleteModal">
                    Delete
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Delete Note</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">Are you sure you want to delete this note?</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-danger">Delete</button>
            </div>
        </div>
    </div>
</div>

<!-- Update Confirmation Modal -->
<div class="modal fade" id="updateModal" tabindex="-1" aria-labelledby="updateModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="updateModalLabel">Update Note</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">Are you sure you want to update this note?</div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button class="btn btn-primary" id="confirmUpdate">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<script>
	// Submit form when "Save Changes" is clicked in the update modal
	document.getElementById("confirmUpdate").addEventListener("click", function () {
		document.getElementById("updateForm").submit();
	});
</script>
